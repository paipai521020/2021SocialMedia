---
title: "SIR模型"
author: "刘琦2020213053015"
date: "2021/10/20"
output: word_document
---


## 简介
在SI模型中，个体一旦被感染，就一直保持感染状态，不存在恢复的情况，是最简单的一种感染模型。然而，在现实生活中，持续感染的症状少之又少，SI模型的适用性也非常小。在大部分情况下，人们感染某疾病后的一段时间后身体里的免疫系统会抵抗病原体，战胜疾病，从染病中恢复过来，并且记忆细胞会记录下此次的抗争过程，从而在一定时间内保持对该疾病的免疫力。这样的情况往往在SI模型中难以体现。为了使其更现实或更适合作为特定疾病的模型，除了S和I外，我们需要第三种疾病状态，通常表示为R。

S、I、R组成的相应的三态模型称为SIR模型。其中S表示易染状态，一个未被感染的个体就处于易染状态，即该个体存在一定的感染几率。I表示感染状态，处于被病毒感染的个体就可以被称为感染状态，同时处于感染状态的个体还存在一定的感染他人的几率。而R状态并不只是表示恢复状态，而是一种移除状态，即我们并不关心处于R状态的个体是否健康恢复还是死亡，只要一个个体经历了一个完整的感染周期，从感染链中除名，都可以用R来表示他的状态。从流行病学的角度来看，无论一个人是恢复健康的还是死亡的，只要他们被有效地从疾病的潜在宿主库中移除，对疾病的影响都很小。从数学的角度来看，让患病的人们或恢复，或死亡的某种结果未定的疾病也可以用这种方式建模。由于这些因素，人们往往认为R代表移除而不是恢复，使得R可以包含这两种可能性，相应的模型被称为移除模型。

SIR模型的流程图为S→I→R。

## 原理
SIR模型的动力学过程主要分为接触和移除两个阶段。

在初始时刻中，只要存在少数或个别被感染的个体I，其余个体都可看作是易染状态，每个个体与其他个体接触时间与几率视为均等，接触与感染状态的个体后有一定几率感染。且在本文中，假设病毒的感染传播时间远小于每个个体的生命周期，故不考虑个体的新生与自然死亡。

在第一阶段中，假设易感个体S在与被感染个体I接触时以平均速率β发生病毒感染。第二阶段，受感染的个体I以平均速率γ进行R阶段---恢复或死亡。当γ值确定时，假设每个受感染个体在恢复前依然患病的时间τ。则在一段时内恢复的δτ概率为γδτ，不恢复的概率为1-γδτ。
假设s,i,t分别为三个状态下的个体比例，且满足s+i+r=1.则SIR模型的微分方程如下：
$$ \frac{\text{d}s}{\text{d}t}=- \beta si$$
$$ \frac{\text{d}i}{\text{d}t}= \beta si- \gamma i$$
$$ \frac{\text{d}r}{\text{d}t}= \gamma i$$
通过1、3两式解方程得到：
$$ \frac{1}{s}\frac{\text{d}i}{\text{d}t}=- \frac{ \beta }{ \gamma }\frac{\text{d}r}{\text{d}t}$$
接着两边积分可得：
$$ s=s_0e^{-\frac{ \beta r}{ \gamma }}$$
其中s0是t=0时s的值.
代入i=1-s-r可得：
$$ \frac{\text{d}r}{\text{d}t}= \gamma （1-r-s_0e^{-\frac{ \beta r}{ \gamma }})$$
其解如下：
$$ t= \frac{1}{ \gamma }\int_{0}^{r} \frac{1}{1-x-s_0e^{-\frac{ \beta r}{ \gamma }}}dx$$
令dr/dt=0得到移除人数的稳态值：
$$r=1-s_0e^{-\frac{ \beta r}{ \gamma }}$$
记λ=β/γ,则最终的r值满足：
$$r=1-e^{-\lambda r}$$

## 代码实现
下面进行一个模拟扩散的过程。

首先创建SIR函数。
```{r}
SIR <- function(time, state, parameters) {

par = as.list(c(state, parameters))

with(par, {

dS = -beta * S * I

dI = beta* S * I - gamma * I

dR = gamma * I

list(c(dS, dI, dR))

})

}
```


输入数据。
```{r}
I = c(1,1,2,12,21,43,90,106,142,173,217,326,421,610,732,950,1374,2382,4152,7102,

10356,15178,20975,25655,33036,38987,44635,54363,58568,67174,75842)

t = 0:30

plot(t,I)


```

从图中可以看出增长速度迅速变大。



带入系数和初始值。
```{r}
N = 8500000

init= c(S = N-I[1], I = I[1], R = 0)
beta=0.55/N
gamma=0.2
a=c(beta,gamma)
para=setNames(a, c("beta", "gamma"))
para
```

计算s、i、t的拟合值。
```{r}
library(deSolve)
library(scatterplot3d)
T= 1:61

fit= data.frame(ode(y = init, times =T, func = SIR, parms =para))
```


绘制传播图像。
```{r}
col= 1:3

matplot(fit$time, fit[ , 2:4], type = "l", xlab = "Day", ylab = "Number of subjects", lwd = 2, lty = 1, col = col)

points(t, I)

title("SIR model", outer = TRUE, line = -2)
```


## 小结
相较于最简单的SI模型，SIR模型多了一种R状态，使其更具有现实性和适用性。但对于R状态的个体被移除感染链后没有进行具体的分析。并且SIR模型是完全基于感染个体接触并传染给易染个体的几率是均等的。而在现实世界中易染个体能接触到的其他个体是有限的，且感染个体能传播的个体几率也是有限的。因此，对SIR模型的研究只能基于理论。


## 参考文献
1 网络科学导论[M].2012.汪小帆，李翔，陈关荣

2 Networks An introduction
